# init.te

allow init proc_last_kmsg:file { setattr };

allow init proc:file { setattr };

# /sys/kernel/tracing
allow init debugfs_tracing_debug:dir { mounton };

# /mnt/vendor/efs
allow init efs_file:dir { mounton };

# Mounting older BL rev's firmware files
allow init vendor_firmware_file:file mounton;

# ion
allow init ion_device:chr_file { read open ioctl };

# AOSP init only covers system_block_device, add our own:
allow init {
    boot_block_device
    dtbo_block_device
}:{ blk_file lnk_file } relabelto;

# rild (00564E445F4D756C7469636C69656E74)
allow init rild:unix_stream_socket { connectto };

allow init default_android_hwservice:hwservice_manager { add find };
allow init hal_nfc_hwservice:hwservice_manager { add find };
allow init hal_system_suspend_service:service_manager find;
allow init hidl_base_hwservice:hwservice_manager add;
allow init nfc:binder call;
allow init self:qipcrtr_socket { create getattr read setopt write };
allow init sysfs_touchscreen_writable:file open;
allow init system_server:binder call;
allow init vendor_file:file { execute execute_no_trans };

# android.hardwar
allow init hwservicemanager:binder { call };

allow init hwservicemanager:binder { call transfer };

allow init same_process_hal_file:file { execute };

allow init self:capability { sys_module };

allow init vendor_persist_sensors_file:file { append };

allow init servicemanager:binder { call };

allow init init:netlink_socket { create bind write read };
